const COMPANY_PHONE_E164="+48796457505",WHATSAPP_NUMBER="+48796457505".replace(/^\+/,""),VIBER_NUMBER=encodeURIComponent("+"+WHATSAPP_NUMBER),TELEGRAM_HANDLE="photo_fox_22",waLink=document.getElementById("waLink"),viberLink=document.getElementById("viberLink"),tgLink=document.getElementById("tgLink"),callLink=document.getElementById("callLink");waLink.href=`https://wa.me/${WHATSAPP_NUMBER}`,viberLink.href=`viber://chat?number=${WHATSAPP_NUMBER}`,tgLink.href="https://t.me/photo_fox_22",callLink.href="tel:+48796457505";const form=document.getElementById("contactForm"),success=document.getElementById("success"),error=document.getElementById("error");function hide(e){e&&(e.style.display="none")}function show(e,t){e&&(void 0!==t&&(e.textContent=t),e.style.display="block")}function normalizePhone(e){let t=String(e||"").trim();return t?(t=t.replace(/\s+/g,"").replace(/[()\-.]/g,""),t.startsWith("00")&&(t="+"+t.slice(2)),!t.startsWith("+")&&/^\d+$/.test(t)||(t=t.replace(/(?!^)\+/g,"").replace(/[^\d+]/g,"")),t):""}function getTurnstileToken(){return form.querySelector('input[name="cf-turnstile-response"]')?.value||""}async function postJSON(e,t,n=2e4){const o=new AbortController,r=setTimeout((()=>o.abort()),n);try{const n=await fetch(e,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t),signal:o.signal}),i=(n.headers.get("content-type")||"").includes("application/json")?await n.json():await n.text();return{ok:n.ok,status:n.status,body:i}}finally{clearTimeout(r)}}form.addEventListener("submit",(async e=>{if(e.preventDefault(),hide(success),hide(error),!form.checkValidity())return void show(error,"Перевірте, будь ласка, обов'язкові поля, помічені зірочкою *");const t=Object.fromEntries(new FormData(form).entries()),n={phone:normalizePhone(t.phone),name:t.name||"",email:t.email||"",country:t.country||"",citizenship:t.citizenship||"",age:t.age||"",gender:t.gender||"",position:t.position||"",message:t.message||"",submittedAt:(new Date).toISOString(),source:location.href,turnstileToken:getTurnstileToken()};if(!n.phone||n.phone.replace(/[^\d]/g,"").length<7)show(error,"Вкажіть коректний номер телефону.");else try{const{ok:e,status:t,body:o}=await postJSON("/api/lead",n,2e4);if(e&&o&&o.ok){if(show(success,"Дякуємо! Заявку надіслано. Ми зв'яжемося з вами найближчим часом."),form.reset(),window.turnstile?.reset)try{window.turnstile.reset()}catch(e){}return}{const e=o&&(o.error||o.message)||`Помилка від сервера (${t}). Спробуємо відправити лист.`;show(error,e)}}catch(e){}}));